function disableMouseDrag(e){e.stopPropagation()}function showStoryNodeWindow(e){const t=onlookerLiveData[e.target.getAttribute("node-code")];document.getElementById("record-win-title").innerText=e.target.title;const o=document.getElementById("record-win-content");o.innerHTML="";for(let e=0;e<t.length;e++){const n=t[e],r=document.createElement("a");r.className="record-item",r.href=n.link,r.target="_blank";for(let e=0;e<n.livers.length;e++){const t=onlookerLiveData[n.livers[e]],o=document.createElement("img");o.className="record-item-avatar",o.src=t.avatar,o.alt=t.name,r.append(o)}const c=document.createElement("div");c.className="record-item-text",c.append(buildTextSpan("record-item-title",n.title)),c.append(buildTextSpan("record-item-subtitle",n.subtitle)),r.append(c),o.append(r)}window.location.hash="#record-win"}function buildTextSpan(e,t){const o=document.createElement("span");return o.className=e,o.innerText=t,o}function loadStoryTree(){const e=document.getElementById("story");e.append(buildStoryNode(onlookerStoryData));const t=document.createElement("div");t.className="sub-storys",e.append(t),appendStoryTreeNode(t,onlookerStoryData.children)}function buildStoryNode(e){const t=document.createElement("img");return t.className="story-node",t.title=e.title,t.setAttribute("node-code",e.code),t.addEventListener("mousedown",disableMouseDrag),t.addEventListener("click",showStoryNodeWindow),t.src=e.img,t.loading="lazy",t}function appendStoryTreeNode(e,t){for(let o=0;o<t.length;o++){const n=t[o],r=document.createElement("div");if(r.className=t.length>1?"sub-story":"sub-story sole",r.append(buildStoryNode(n)),n.children){const e=document.createElement("div");e.className="sub-storys",appendStoryTreeNode(e,n.children),r.append(e)}e.append(r)}}document.addEventListener("DOMContentLoaded",(function(){loadStoryTree();const e=document.body;e.scrollTo(0,(e.scrollHeight-e.clientHeight)/2),e.style.cursor="grab";let t={top:0,left:0,x:0,y:0};const o=function(o){const n=o.clientX-t.x,r=o.clientY-t.y;e.scrollTop=t.top-r,e.scrollLeft=t.left-n},n=function(){e.style.cursor="grab",e.style.removeProperty("user-select"),document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",n)};e.addEventListener("mousedown",(function(r){e.style.cursor="grabbing",e.style.userSelect="none",t={left:e.scrollLeft,top:e.scrollTop,x:r.clientX,y:r.clientY},document.addEventListener("mousemove",o),document.addEventListener("mouseup",n)})),-1===document.cookie.indexOf("onlookerNoticed")&&(window.location.hash="#steam-record-win",document.cookie="onlookerNoticed=1; expires=Fri, 31 Dec 9999 23:59:59 GMT")}));